<div class="p-fluid">
    <p-toast />
    <div class="filter-section">
        <p-dropdown [options]="weekdays" [(ngModel)]="selectedWeekday" (onChange)="onSelectionChange()"
            placeholder="Гариг">
        </p-dropdown>
        <p-dropdown [options]="classTypes" [(ngModel)]="selectedClassType" (onChange)="onSelectionChange()"
            placeholder="Төрөл">
        </p-dropdown>
        <p-dropdown [options]="times" [(ngModel)]="selectedTimes" (onChange)="onSelectionChange()" placeholder="Цаг">
        </p-dropdown>
        <button pButton type="button" *ngIf="!showPreviousWeeks" label="Өмнөх долоо хоногуудыг харах"
            (click)="togglePreviousWeeks()"></button>
        <button pButton type="button" *ngIf="showPreviousWeeks" label="Одоогийн долоо хоногийг харах"
            (click)="togglePreviousWeeks()"></button>
        <button pButton type="button" label="Хадгалах" (click)="save()"></button>
    </div>

    <p-table [value]="attendanceRecords">
        <ng-template pTemplate="header">
            <tr *ngIf="!showPreviousWeeks">
                <th>№</th>
                <th>Оюутан</th>
                <th> {{ getCurrentWeeks() }} </th>
            </tr>
            <tr *ngIf="showPreviousWeeks">
                <th>№</th>
                <th>Оюутан</th>
                <th *ngFor="let week of getAllWeeks()">
                    {{ week }}
                </th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-record let-ri="rowIndex">
            <tr *ngIf="!showPreviousWeeks">
                <td> {{ ri + 1 }} </td>
                <td>{{ record.student.code }} - {{ record.student.name }}</td>
                <td>
                    <div class="mur">
                        <p-inputNumber class="max-w-3rem" styleClass="max-w-3rem" inputStyleClass="max-w-3rem"
                            [(ngModel)]="record.attendance[getCurrentWeeks()]"></p-inputNumber>
                        <p-inputNumber class="max-w-3rem" styleClass="max-w-3rem" inputStyleClass="max-w-3rem"
                            [(ngModel)]="record.attendance[getCurrentWeeks()]"></p-inputNumber>
                    </div>
                </td>
            </tr>
            <tr *ngIf="showPreviousWeeks">
                <td> {{ ri + 1 }} </td>
                <td>{{ record.student.code }} - {{ record.student.name }}</td>
                <td *ngFor="let week of getAllWeeks()">
                    <div class="mur">
                        <p-inputNumber class="max-w-3rem" styleClass="max-w-3rem" inputStyleClass="max-w-3rem"
                            [(ngModel)]="record.attendance[week]"></p-inputNumber>
                        <p-inputNumber class="max-w-3rem" styleClass="max-w-3rem" inputStyleClass="max-w-3rem"
                            [(ngModel)]="record.attendance[week]"></p-inputNumber>
                    </div>
                </td>
            </tr>
        </ng-template>
    </p-table>
</div>